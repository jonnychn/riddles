
<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>üèÆ ÂÖÉÂÆµÁåúÁáàË¨é</title>
<style>
  * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }

  :root {
    --red: #c0392b;
    --red-dark: #962d22;
    --red-light: #e74c3c;
    --gold: #f39c12;
    --gold-light: #f7dc6f;
    --gold-dark: #d4890a;
    --cream: #fdf6e3;
    --text: #2c1810;
    --shadow: rgba(0,0,0,0.25);
  }

  body {
    font-family: 'PingFang TC', 'Noto Sans TC', 'Microsoft JhengHei', sans-serif;
    background: var(--red);
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    background-image:
      radial-gradient(ellipse at top, #e74c3c 0%, #c0392b 50%, #962d22 100%);
  }

  #app {
    width: 100%;
    max-width: 480px;
    min-height: 100vh;
    position: relative;
    overflow: hidden;
  }

  /* ========= SCREENS ========= */
  .screen {
    display: none;
    width: 100%;
    min-height: 100vh;
    padding: 0 0 40px 0;
    animation: fadeIn 0.3s ease;
  }
  .screen.active { display: block; }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(8px); }
    to   { opacity: 1; transform: translateY(0); }
  }

  /* ========= HOME SCREEN ========= */
  #home-header {
    text-align: center;
    padding: 36px 20px 24px;
    background: linear-gradient(180deg, rgba(0,0,0,0.15) 0%, transparent 100%);
  }

  .lantern-row {
    font-size: 2.4rem;
    letter-spacing: 8px;
    display: block;
    animation: sway 3s ease-in-out infinite alternate;
  }

  @keyframes sway {
    from { transform: rotate(-3deg); }
    to   { transform: rotate(3deg); }
  }

  #home-header h1 {
    color: var(--gold-light);
    font-size: 2rem;
    font-weight: 900;
    text-shadow: 0 2px 8px rgba(0,0,0,0.4);
    margin: 8px 0 4px;
    letter-spacing: 2px;
  }

  #home-header p {
    color: rgba(255,255,255,0.85);
    font-size: 0.9rem;
    letter-spacing: 1px;
  }

  /* Random button */
  #random-btn {
    display: block;
    margin: 0 20px 24px;
    padding: 16px;
    background: linear-gradient(135deg, var(--gold), var(--gold-dark));
    color: var(--text);
    border: none;
    border-radius: 14px;
    font-size: 1.1rem;
    font-weight: 700;
    cursor: pointer;
    box-shadow: 0 4px 16px rgba(0,0,0,0.3);
    letter-spacing: 1px;
    transition: transform 0.1s, box-shadow 0.1s;
    width: calc(100% - 40px);
  }
  #random-btn:active { transform: scale(0.97); box-shadow: 0 2px 8px rgba(0,0,0,0.3); }

  /* Category cards */
  .categories-label {
    color: var(--gold-light);
    font-size: 0.8rem;
    letter-spacing: 3px;
    text-align: center;
    margin-bottom: 12px;
    opacity: 0.8;
  }

  .categories-grid {
    display: flex;
    flex-direction: column;
    gap: 10px;
    padding: 0 20px;
  }

  .cat-card {
    background: rgba(255,255,255,0.12);
    border: 1px solid rgba(255,215,0,0.3);
    border-radius: 14px;
    padding: 18px 20px;
    cursor: pointer;
    transition: transform 0.15s, background 0.15s;
    display: flex;
    align-items: center;
    gap: 14px;
    backdrop-filter: blur(4px);
  }
  .cat-card:active { transform: scale(0.97); background: rgba(255,255,255,0.2); }

  .cat-icon { font-size: 1.8rem; flex-shrink: 0; }

  .cat-info { flex: 1; }
  .cat-name { color: #fff; font-size: 1.05rem; font-weight: 700; }
  .cat-hint { color: rgba(255,255,255,0.6); font-size: 0.78rem; margin-top: 2px; }

  .cat-badge {
    background: var(--gold);
    color: var(--text);
    font-size: 0.75rem;
    font-weight: 800;
    padding: 4px 10px;
    border-radius: 20px;
    flex-shrink: 0;
  }

  /* ========= GAME SCREEN ========= */
  #game-header {
    display: flex;
    align-items: center;
    padding: 16px 16px 12px;
    gap: 10px;
  }

  #back-btn {
    background: rgba(255,255,255,0.15);
    border: none;
    color: #fff;
    font-size: 1.4rem;
    width: 42px;
    height: 42px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    transition: background 0.15s;
  }
  #back-btn:active { background: rgba(255,255,255,0.3); }

  #game-cat-label {
    color: var(--gold-light);
    font-size: 0.9rem;
    font-weight: 600;
    flex: 1;
  }

  #shuffle-btn {
    background: rgba(255,255,255,0.15);
    border: none;
    color: #fff;
    font-size: 1.1rem;
    width: 42px;
    height: 42px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background 0.15s, transform 0.3s;
  }
  #shuffle-btn:active { background: rgba(255,255,255,0.3); transform: rotate(180deg); }

  /* Progress bar */
  #progress-wrap {
    padding: 0 16px 16px;
  }
  #progress-track {
    background: rgba(255,255,255,0.2);
    border-radius: 99px;
    height: 6px;
    overflow: hidden;
  }
  #progress-fill {
    height: 100%;
    background: var(--gold);
    border-radius: 99px;
    transition: width 0.4s ease;
  }
  #progress-label {
    color: rgba(255,255,255,0.7);
    font-size: 0.75rem;
    text-align: right;
    margin-top: 4px;
  }

  /* Riddle card */
  #riddle-card {
    margin: 0 16px;
    background: var(--cream);
    border-radius: 20px;
    padding: 28px 24px;
    box-shadow: 0 8px 32px rgba(0,0,0,0.3);
    min-height: 220px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    position: relative;
    overflow: hidden;
  }

  #riddle-card::before {
    content: 'Ë¨é';
    position: absolute;
    top: -10px;
    right: -10px;
    font-size: 80px;
    color: rgba(192,57,43,0.06);
    font-weight: 900;
    pointer-events: none;
  }

  #riddle-text {
    font-size: 1.45rem;
    font-weight: 700;
    color: var(--text);
    text-align: center;
    line-height: 1.7;
    letter-spacing: 0.5px;
  }

  #riddle-category-tag {
    font-size: 0.72rem;
    color: var(--red);
    background: rgba(192,57,43,0.1);
    padding: 3px 10px;
    border-radius: 99px;
    margin-bottom: 14px;
    font-weight: 600;
    letter-spacing: 1px;
  }

  /* Answer section */
  #answer-section {
    margin-top: 20px;
    width: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 12px;
  }

  #reveal-btn {
    background: linear-gradient(135deg, var(--red-light), var(--red));
    color: #fff;
    border: none;
    border-radius: 12px;
    padding: 14px 32px;
    font-size: 1.05rem;
    font-weight: 700;
    cursor: pointer;
    box-shadow: 0 4px 14px rgba(192,57,43,0.4);
    transition: transform 0.1s, box-shadow 0.1s;
    letter-spacing: 1px;
    width: 100%;
  }
  #reveal-btn:active { transform: scale(0.97); }

  #answer-box {
    display: none;
    width: 100%;
    background: linear-gradient(135deg, #fff8e1, #fff3cd);
    border: 2px solid var(--gold);
    border-radius: 12px;
    padding: 16px 20px;
    text-align: center;
    animation: popIn 0.4s cubic-bezier(0.34,1.56,0.64,1);
  }
  #answer-box.visible { display: block; }

  @keyframes popIn {
    from { transform: scale(0.7); opacity: 0; }
    to   { transform: scale(1);   opacity: 1; }
  }

  #answer-label {
    font-size: 0.72rem;
    color: var(--gold-dark);
    font-weight: 600;
    letter-spacing: 2px;
    margin-bottom: 6px;
  }

  #answer-text {
    font-size: 2rem;
    font-weight: 900;
    color: var(--red-dark);
    letter-spacing: 2px;
  }

  /* Navigation */
  #nav-row {
    display: flex;
    gap: 10px;
    margin: 20px 16px 0;
  }

  .nav-btn {
    flex: 1;
    background: rgba(255,255,255,0.15);
    border: 1px solid rgba(255,255,255,0.25);
    color: #fff;
    border-radius: 12px;
    padding: 14px;
    font-size: 1rem;
    font-weight: 700;
    cursor: pointer;
    transition: background 0.15s, transform 0.1s;
    letter-spacing: 1px;
  }
  .nav-btn:active { background: rgba(255,255,255,0.28); transform: scale(0.97); }
  .nav-btn:disabled { opacity: 0.35; cursor: default; }

  /* ========= CONFETTI ========= */
  #confetti-container {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    pointer-events: none;
    z-index: 999;
    overflow: hidden;
  }

  .confetti-piece {
    position: absolute;
    width: 10px;
    height: 14px;
    border-radius: 2px;
    opacity: 0;
    animation: confettiFall var(--dur, 1.2s) ease-in var(--delay, 0s) forwards;
  }

  @keyframes confettiFall {
    0%   { opacity: 1; transform: translateY(0) rotate(0deg) scale(1); }
    80%  { opacity: 1; }
    100% { opacity: 0; transform: translateY(var(--fall, 600px)) rotate(var(--rot, 540deg)) scale(0.6); }
  }

  /* ========= SWIPE HINT ========= */
  #swipe-hint {
    text-align: center;
    color: rgba(255,255,255,0.45);
    font-size: 0.72rem;
    margin-top: 16px;
    letter-spacing: 1px;
  }
</style>
</head>
<body>
<div id="app">
  <div id="confetti-container"></div>

  <!-- ===== HOME SCREEN ===== -->
  <div id="screen-home" class="screen active">
    <div id="home-header">
      <span class="lantern-row">üèÆ üèÆ üèÆ</span>
      <h1>ÂÖÉÂÆµÁåúÁáàË¨é</h1>
      <p>ÈªûÈÅ∏È°ûÂà•ÈñãÂßãÁåúË¨éÔºÅ</p>
    </div>

    <button id="random-btn">üé≤ Èö®Ê©ü‰æÜ‰∏ÄÈ°å</button>

    <p class="categories-label">‚ñ∏ ÈÅ∏ÊìáÈ°ûÂà• ‚óÇ</p>

    <div class="categories-grid" id="categories-grid"></div>
  </div>

  <!-- ===== GAME SCREEN ===== -->
  <div id="screen-game" class="screen">
    <div id="game-header">
      <button id="back-btn" title="ËøîÂõû">‚Üê</button>
      <span id="game-cat-label"></span>
      <button id="shuffle-btn" title="Ê¥óÁâå">üîÄ</button>
    </div>

    <div id="progress-wrap">
      <div id="progress-track"><div id="progress-fill"></div></div>
      <div id="progress-label"></div>
    </div>

    <div id="riddle-card">
      <div id="riddle-category-tag"></div>
      <div id="riddle-text"></div>
      <div id="answer-section">
        <button id="reveal-btn">üí° È°ØÁ§∫Á≠îÊ°à</button>
        <div id="answer-box">
          <div id="answer-label">Á≠îÊ°àÊòØ‚Ä¶</div>
          <div id="answer-text"></div>
        </div>
      </div>
    </div>

    <div id="nav-row">
      <button class="nav-btn" id="prev-btn">‚óÄ ‰∏ä‰∏ÄÈ°å</button>
      <button class="nav-btn" id="next-btn">‰∏ã‰∏ÄÈ°å ‚ñ∂</button>
    </div>

    <div id="swipe-hint">‚Üê Â∑¶Âè≥ÊªëÂãïÊèõÈ°å ‚Üí</div>
  </div>
</div>

<script>
// ================================================================
// DATA
// ================================================================
const CATEGORIES = [
  {
    id: 'char',
    name: 'Áåú‰∏ÄÂÄãÂ≠ó',
    icon: 'üàµ',
    hint: 'ÁåúÂ≠óË¨éÔºåÂãïÂãïËÖ¶ÔºÅ',
    riddles: [
      { q: 'ÊâãË™ûÔºàÁåú‰∏ÄÂ≠óÔºâ', a: 'Êâπ' },
      { q: 'Â§ö‰∏ÄÂçäÔºàÁåú‰∏ÄÂ≠óÔºâ', a: 'Â§ï' },
      { q: '‰πùÂçÅ‰πùÔºàÁåú‰∏ÄÂ≠óÔºâ', a: 'ÁôΩ' },
      { q: '‰∏Ä‰∫∫Âú®ÂÖßÔºàÁåú‰∏ÄÂ≠óÔºâ', a: 'ËÇâ' },
      { q: 'ÂçÅÂÄãÂì•Âì•ÔºàÁåú‰∏ÄÂ≠óÔºâ', a: 'ÂÖã' },
      { q: 'ÈáëÊú®Ê∞¥ÁÅ´ÔºàÁåú‰∏ÄÂ≠óÔºâ', a: 'Âùé' },
      { q: 'ÊúâÈªûËá™Â§ßÔºàÁåú‰∏ÄÂ≠óÔºâ', a: 'Ëá≠' },
      { q: 'ÁõÆÁ©∫‰∏ÄÂàáÔºàÁåú‰∏ÄÂ≠óÔºâ', a: 'Âè£' },
      { q: 'Áæé‰∏≠‰∏çË∂≥ÔºàÁåú‰∏ÄÂ≠óÔºâ', a: 'Áæä' },
      { q: 'Áî∑ÁîüÂ§™Â§öÔºàÁåú‰∏ÄÂ≠óÔºâ', a: 'Â¶ô' },
      { q: 'ÊóÖË°åÂùêÈ£õÊ©üÔºàÁåú‰∏ÄÂ≠óÔºâ', a: 'Ëº©' },
      { q: 'Êó©‰∏çË™™Êôö‰∏çË™™ÔºàÁåú‰∏ÄÂ≠óÔºâ', a: 'Ë®±' },
      { q: '‰∏É‰∫∫È†≠‰∏äÈï∑ËçâÔºàÁåú‰∏ÄÂ≠óÔºâ', a: 'Ëä±' },
      { q: '‰∏ÄÂè£ÂêÉÊéâÁâõÂ∞æÂ∑¥ÔºàÁåú‰∏ÄÂ≠óÔºâ', a: 'Âëä' },
      { q: 'Â§ßÁÅ´ÁáíÂà∞ËÄ≥ÊúµÈÇäÔºàÁåú‰∏ÄÂ≠óÔºâ', a: 'ËÄø' },
      { q: 'ÂÖ´ÂÄãÂÖÑÂºü‰∏ÄËµ∑Ë≥ûÊúàÔºàÁåú‰∏ÄÂ≠óÔºâ', a: 'ËÑ´' },
      { q: 'Âè™ÊúâÂßêÂßêÂ¶πÂ¶πÂíåÂºüÂºüÔºàÁåú‰∏ÄÂ≠óÔºâ', a: 'Ê≠å' },
      { q: 'ÈúÄË¶Å‰∏ÄÂçäÔºåÁïô‰∏ã‰∏ÄÂçäÔºàÁåú‰∏ÄÂ≠óÔºâ', a: 'Èõ∑' },
      { q: '‰∏ÄÂÆ∂ÊúâÂõõÂè£ÔºåÈÇÑÊúâ‰∏ÄÈöªÁãóÔºàÁåú‰∏ÄÂ≠óÔºâ', a: 'Âô®' },
      { q: '‰∏Ä‰∫∫‰∏ÄÂºµÂè£ÔºåÂè£‰∏ãÈï∑Âè™ÊâãÔºàÁåú‰∏ÄÂ≠óÔºâ', a: 'Êãø' },
    ]
  },
  {
    id: 'person',
    name: 'Áåú‰∫∫Áâ©',
    icon: 'üåü',
    hint: 'ÊòéÊòü„ÄÅÂç°ÈÄö„ÄÅÊ≠∑Âè≤‰∫∫Áâ©ÔºÅ',
    riddles: [
      { q: 'ÂúãÁéãÊê≠È£õÊ©üÔºàÁåú‰∏ÄÊòéÊòüÔºâ', a: 'ÁéãËè≤ÔºàÁéã"È£õ"Ôºâ' },
      { q: 'ÈáëÈáëÈáëÈáëÈáëÔºàÁåú‰∏ÄÊòéÊòüÔºâ', a: 'ÈáëÂüéÊ≠¶ÔºàÈáë"‰πò‰∫î"Ôºâ' },
      { q: 'ËöäÂ≠êÂèÆÈº†ÁâõËôéÂÖîÈæçËõáÈ¶¨ÁæäÁå¥ÈõûË±¨ÔºàÁåú‰∏ÄÂç°ÈÄö‰∫∫Áâ©Ôºâ', a: 'Â∏É‰∏ÅÁãóÔºà"‰∏çÂèÆ"ÁãóÔºâ' },
      { q: 'Áî®ÂÖ©ÈöªËÖ≥Ëµ∞Ë∑ØÁöÑËÄÅÈº†ÔºàÁåú‰∏ÄÂç°ÈÄö‰∫∫Áâ©Ôºâ', a: 'Á±≥ËÄÅÈº†' },
      { q: 'ÈõªË¶ñÊ©üËÅ≤Èü≥ÈóúÂ∞èËÅ≤ÈªûÔºàÁåú‰∏ÄÁ•ûÊòéÔºâ', a: 'ËßÄ‰∏ñÈü≥ÔºàÈü≥‰ºº„ÄåÈóúÂ∞èËÅ≤„ÄçÔºâ' },
      { q: 'ÈôçËêΩÂÇòÔºàÁåú‰∏ÄÊ≠∑Âè≤‰∫∫Áâ©Ôºâ', a: 'ÂºµÈ£õ' },
      { q: 'ÂõûÈ†≠ÊòØÂ≤∏ÔºàÁåú‰∏ÄÊ≠∑Âè≤ÊñáÂ≠∏ÂÆ∂Ôºâ', a: 'Ê≠∏ÊúâÂÖâ' },
      { q: 'Ëñè‰ªÅË¢´Ë∂ïÂá∫ÂÆ∂ÈñÄÔºàÁåú‰∏ÄÁ®Æ‰∫∫Áâ©Ôºâ', a: 'Ë°óÈ†≠Ëóù‰∫∫' },
      { q: '‰∏ÄÂè£‰∫ï„ÄÅ‰∏ÄÊùØËå∂„ÄÅÂÖ©ÂÄãÊùØÂ≠êÔºàÁåú‰∏ÄÁ®Æ‰∫∫Áâ©Ôºâ', a: 'Ë≠¶ÂØü‰ºØ‰ºØÔºà"‰∫ï„ÄÅËå∂„ÄÅÊùØ„ÄÅÊùØ"Ôºâ' },
      { q: 'Èªë‰∫∫ÂíåÁôΩÈõ™ÂÖ¨‰∏ªÁµêÂ©öÁîü‰∏ãÁöÑÂ∞èÂ≠©ÔºàÁåú‰∏ÄÁ´•Ë©±ÊïÖ‰∫ã‰∫∫Áâ©Ôºâ', a: 'ÁÅ∞ÂßëÂ®òÔºàÁôΩ+Èªë=ÁÅ∞Ôºâ' },
    ]
  },
  {
    id: 'object',
    name: 'ÁåúÁâ©ÂìÅ',
    icon: 'üéÅ',
    hint: 'Êó•Â∏∏ÁîüÊ¥ªÁâ©ÂìÅÁåúÁåúÁúãÔºÅ',
    riddles: [
      { q: 'Êãø‰∫∫ÈºªÂ≠êÁï∂È¶¨È®éÔºàÁåú‰∏ÄÁâ©ÂìÅÔºâ', a: 'ÁúºÈè°' },
      { q: 'Âá∫ÂÖ•ÊàêÈõôÔºåÈÖ∏ÁîúËã¶Ëæ£Âë≥Á∏ΩÂÖàÂöêÔºàÁåú‰∏ÄÁâ©ÂìÅÔºâ', a: 'Á≠∑Â≠ê' },
      { q: '‰∏çËÉΩÂêÉ‰∏çËÉΩÂñùÔºåÊØèÂ§©ÈÉΩË¶ÅÂöê‰∏ÄÂè£ÔºàÁåú‰∏ÄÁâ©ÂìÅÔºâ', a: 'ÁâôËÜè' },
      { q: 'Á∂†Ë°£Êº¢ÔºåË°ó‰∏äÁ´ôÔºåÂÖâÂêÉÁ¥ôÔºå‰∏çÂêÉÈ£ØÔºàÁåú‰∏ÄÁâ©ÂìÅÔºâ', a: 'ÈÉµÁ≠í' },
      { q: '‰∏ÄÂÄãÂÖ•Âè£ÔºåÂÖ©Ê¢ùÈößÈÅìÔºåÂè™ÈÄ≤‰∏ÄÊ¢ùÔºåÁÑ°Ê≥ï‰ΩøÁî®ÔºàÁåú‰∏ÄÁâ©ÂìÅÔºâ', a: 'Ë§≤Â≠ê' },
      { q: 'ÊúâÁ°¨ÊúâËªüÔºåÊúâÈï∑ÊúâÂØ¨ÔºåÁôΩÂ§©Á©∫ÈñíÔºåÂ§úÊôö‰∏äÁè≠ÔºàÁåú‰∏ÄÁâ©ÂìÅÔºâ', a: 'Â∫ä' },
      { q: 'ÊåáËëó‰Ω†ÁöÑËáâ„ÄÅÊåâËëó‰Ω†ÁöÑÂøÉÔºåÈÄöÁü•‰Ω†‰∏ª‰∫∫ÔºåË∂ïÂø´‰æÜÈñãÈñÄÔºàÁåú‰∏ÄÁâ©ÂìÅÔºâ', a: 'ÈñÄÈà¥' },
      { q: 'ÊúÉËµ∞Ê≤íÊúâËÖøÔºåÊúÉÂêÉÊ≤íÊúâÂò¥ÔºåÈÅéÊ≤≥Ê≤íÊúâÊ∞¥ÔºåÊ≠ª‰∫ÜÊ≤íÊúâÈ¨ºÔºàÁåú‰∏ÄÁâ©ÂìÅÔºâ', a: 'Ë±°Ê£ã' },
      { q: 'ÈÅ†ÁúãÂÉèÂ∞è‰∏òÔºåËøëÁúãÂÉèÊ®ìÊ¢ØÔºå‰∏äÂéª‰∏ÄÊ≠•Ê≠•Ôºå‰∏Ä‰∏ãÊªëÂà∞Â∫ïÔºàÁåú‰∏ÄÁâ©ÂìÅÔºâ', a: 'ÊªëÊ¢Ø' },
      { q: 'ÂâçÈù¢‰æÜÈöªËàπÔºåËàµÊâãÂú®‰∏äÈÇäÔºå‰æÜÊôÇ‰∏ãÂ∞èÈõ®ÔºåËµ∞ÂæåË∑ØÂ∑≤‰πæÔºàÁåú‰∏ÄÁâ©ÂìÅÔºâ', a: 'ÁÜ®Êñó' },
    ]
  },
  {
    id: 'food',
    name: 'ÁåúÈ£üÁâ©ÔºèÊ∞¥Êûú',
    icon: 'üçä',
    hint: 'ÂêÉË≤®ÂøÖÂãùÔºÅ',
    riddles: [
      { q: '‰∏ÄÁ®ÆÈ£üÁâ©Êúâ‰∏âÂÄãÂßìÊ∞èÔºàÁåú‰∏ÄÈ£üÁâ©Ôºâ', a: 'ÁæÖÂÆãÊπØ' },
      { q: 'È¶¨‰∏ç‰ø°ÔºåÊääËÄÅÈº†Êè™‰∫ÜËµ∑‰æÜÔºàÁåú‰∏ÄÈ£üÁâ©Ôºâ', a: 'È¶¨Èà¥ËñØÔºà"È¶¨ÊãéÈº†"Ôºâ' },
      { q: '‰∏ãÈù¢ÊòØÁÅ´Â±±Ôºå‰∏äÈù¢ÊòØÂ§ßÊµ∑ÔºåÊµ∑ÈáåÂØ∂Ë≤ùÂ§öÔºåÂø´Âø´Êíà‰∏ä‰æÜÔºàÁåú‰∏ÄÈ£üÁâ©Ôºâ', a: 'ÁÅ´Èçã' },
      { q: 'ÁèçÁè†ÁôΩÂßëÂ®òÔºåË®±ÈÖçÁ´πËëâÈÉéÔºåÁ©øË°£ÂéªÊ¥óÊæ°ÔºåËÑ´Ë°£‰∏äÁâôÂ∫äÔºàÁåú‰∏ÄÈ£üÁâ©Ôºâ', a: 'Á≤ΩÂ≠ê' },
      { q: 'Êú¨‰æÜ‰∏ÄÂ§ßÁâáÔºåËÆäÊàêÊ¢ùÊ¢ùÁ∑öÔºåÊòØÁ∑ö‰∏çÂÅöË°£ÔºåÁ¢óË£°Â∏∏Â∏∏Ë¶ãÔºàÁåú‰∏ÄÈ£üÁâ©Ôºâ', a: 'È∫µÊ¢ù' },
      { q: 'ÁôΩÁôΩË∫´Â≠êÂúìÊ∫úÊ∫úÔºåÊ®£Â≠êÂÉèÂÄãÊ°åÁêÉÔºåÊîæÂú®ÈçãÈáåÁÖÆ‰∏ÄÁÖÆÔºåÂÖ®ÂÆ∂ÂêÉÂÆÉÈÅéÂçÅ‰∫îÔºàÁåú‰∏ÄÈ£üÁâ©Ôºâ', a: 'ÊπØÂúì' },
      { q: 'ÂÖÑÂºüÂÖ©ÂÄãÁò¶ÂèàÈï∑ÔºåÊâ≠Âú®‰∏ÄËµ∑‰∏ãÊ±†Â°òÔºåÊ±†Â°òË£°Èù¢ÊâìÂÄãÊªæÔºåÊíàËµ∑ËÆäÂæóÈªÉÂèàËÉñÔºàÁåú‰∏ÄÈ£üÁâ©Ôºâ', a: 'Ê≤πÊ¢ù' },
      { q: 'ÁôΩÂèàÊñπÔºåÂ´©ÂèàÈ¶ôÔºåËÉΩÂÅöËèúÔºåËÉΩÁÖÆÊπØÔºåË±ÜÂ≠êÊòØÂÆÉÁàπÂíåÂ™ΩÔºåÂÆÉÂíåÁàπÂ™Ω‰∏ç‰∏ÄÊ®£ÔºàÁåú‰∏ÄÈ£üÁâ©Ôºâ', a: 'Ë±ÜËÖê' },
      { q: 'ÂΩéÂΩéÊõ≤Êõ≤ÂÉèÂΩàÁ∞ßÔºåË¢ãË¢ãÁõíÁõíË£°Èù¢Ë£ùÔºåÊÉ≥Ë¶ÅÂêÉÂÆÉÂæàÊñπ‰æøÔºåÂè™ÈúÄÈñãÊ∞¥Ááô‰∏ÄÁáôÔºàÁåú‰∏ÄÈ£üÁâ©Ôºâ', a: 'Ê≥°È∫µ' },
      { q: '‰∏çÂπ≥Âá°ÁöÑÁµêÊûúÔºàÁåú‰∏ÄÊ∞¥ÊûúÔºâ', a: 'Â•áÁï∞Êûú' },
      { q: 'ÂúìÂúìÁöÑË∫´È´îÔºåÂÖ®Ë∫´ÊòØÁñôÁò©ÔºåÊúâÈªûÂÉèËã¶ÁìúÔºàÁåú‰∏ÄÊ∞¥ÊûúÔºâ', a: 'ÈáãËø¶' },
      { q: 'Â∞èÂ∞èÁΩàÂ≠êÔºåË£ùÊªøÈ§ÉÂ≠êÔºåÂêÉÊéâÈ§ÉÂ≠êÔºåÂêêÂá∫Áè†Â≠êÔºàÁåú‰∏ÄÊ∞¥ÊûúÔºâ', a: 'Ê©òÂ≠ê' },
      { q: 'ËÑ´‰∫ÜÁ¥ÖË¢çÂ≠êÔºåÊòØÂÄãÁôΩËÉñÂ≠êÔºõÂéª‰∫ÜÁôΩËÉñÂ≠êÔºåÊòØÈ°ÜÈªë‰∏∏Â≠êÔºàÁåú‰∏ÄÊ∞¥ÊûúÔºâ', a: 'ËçîÊûù' },
      { q: 'Ë∫´‰∏äÈï∑ÁôΩÊØõÔºåÁ¥ÖÂ∞ñÂò¥ÂÖíÁøπÔºåËÉå‰∏ä‰∏ÄÊ¢ùÊ∫ùÔºåËÇöË£°Â•ΩÂë≥ÈÅìÔºàÁåú‰∏ÄÊ∞¥ÊûúÔºâ', a: 'Ê∞¥ËúúÊ°É' },
      { q: 'ÊúâÊ∞¥ÂæàÂ§ö‰∏çÊòØ‰∫ïÔºåËÇ•ËÇ•ËÉñËÉñ‰∏çÊòØË±¨ÔºõÈÆÆÁ¥ÖÊ¨≤Êª¥‰∏çÊòØËÇâÔºåÂúìÂúìÊªæÊªæ‰∏çÊòØÁêÉÔºàÁåú‰∏ÄÊ∞¥ÊûúÔºâ', a: 'Ë•øÁìú' },
    ]
  },
  {
    id: 'fun',
    name: 'ÂâµÊÑèË∂£Âë≥',
    icon: 'üòÇ',
    hint: 'ËÖ¶Á≠ãÊÄ•ËΩâÂΩéÔºåÁ¨ëÂà∞ËÇöÂ≠êÁóõÔºÅ',
    riddles: [
      { q: 'ÁÜäË≤ì‰∏ÄÁîü‰∏≠ÊúÄÂ§ßÁöÑÈÅ∫ÊÜæÊòØ‰ªÄÈ∫ºÔºü', a: 'Ê≤íÊúâÂΩ©Ëâ≤ÁÖßÁâá' },
      { q: 'ÁÇ∫‰ªÄÈ∫ºÂêéÁæøÂ∞ÑÊó•Âè™Â∞Ñ‰∏ã‰πùÂÄãÂ§™ÈôΩÔºü', a: '‰ªñ‰∏çÊÉ≥Êë∏ÈªëÂõûÂÆ∂' },
      { q: '‰∏ÄÊ†πÁ∑öÂèØ‰ª•ÁπîÊàê‰∏ÄÊ¢ùÈï∑Â∏ÉÔºåÈÇ£ÂÖ©Ê†πÁ∑öÂë¢Ôºü', a: '‰∏ÄÊ¢ùÊõ¥Èï∑ÁöÑÂ∏É' },
      { q: 'ÁéãÂ§ßÂ¨∏Êï¥Â§©Ë™™ÂÄã‰∏çÂÅúÔºåÂèØÊòØÊúâ‰∏ÄÂÄãÊúàÂ•πË™™ÂæóÊúÄÂ∞ëÔºåÊòØÂì™ÂÄãÊúàÔºü', a: '‰∫åÊúà‰ªΩ' },
      { q: 'ËªüÁ≥ñÂì≠‰∫ÜÊúÉËÆäÊàê‰ªÄÈ∫ºÔºü', a: 'QQ ËªüÁ≥ñÔºàÂì≠Âì≠ËªüÁ≥ñÔºâ' },
      { q: 'Êó•ÊúàÊΩ≠ÁöÑ‰∏≠ÈñìÊòØ‰ªÄÈ∫ºÔºü', a: 'Êúà' },
      { q: '‰ªÄÈ∫ºÁì∑Âô®ÊúÄË≤¥Ôºü', a: 'Á¢∞Áì∑' },
      { q: 'ÂñùÂì™‰∏ÄÁ®ÆÊûúÊ±ÅÊúÄËæõËã¶Ôºü', a: 'ÁµûÁõ°ËÖ¶Ê±Å' },
      { q: 'ÁÇ∫‰ªÄÈ∫ºÂ§ßÈÉ®‰ªΩ‰ΩõÊïôÂæíÈÉΩÂú®ÂåóÂçäÁêÉÔºü', a: 'Âõ†ÁÇ∫Âçó„ÄåÁÑ°„ÄçÈòøÂΩåÈôÄ‰Ωõ' },
      { q: 'ÁÖÆ‰∏ÄÈ°ÜËõãË¶ÅÂõõÂàÜÈêòÔºåÁÖÆÂÖ´È°ÜËõãË¶ÅÂπæÂàÜÈêòÔºü', a: 'ÂõõÂàÜÈêò' },
      { q: '‰ªÄÈ∫ºÊù±Ë•øÁ†¥‰∫ÜÂçªËÆäÂæóÊõ¥Â•ΩÔºü', a: 'Á¥ÄÈåÑ' },
      { q: 'ÂêÉ‰ªÄÈ∫ºÊòØÊúÄÂÆâÂÖ®ÁöÑÔºü', a: 'ÂêÉËôß' },
      { q: 'Áî®‰ªÄÈ∫ºËæ¶Ê≥ïÂèØ‰ª•ËÆìÁúâÊØõÈï∑Âú®ÁúºÁùõ‰∏ãÈù¢Ôºü', a: 'ÂÄíÁ´ã' },
      { q: '‰ΩúÂÆ∂ÁöÑÊúÄÂæå‰∏ÄÊú¨Êõ∏ÊòØ‰ªÄÈ∫ºÊõ∏Ôºü', a: 'ÈÅ∫Êõ∏' },
      { q: 'ÈòøÊãâ‰∏ÅÊúâÂπæÂÄãÂì•Âì•Ôºü', a: '‰∏âÂÄãÔºàÈòøÊãâ„ÄåÁî≤„Äç„ÄÅÈòøÊãâ„Äå‰πô„Äç„ÄÅÈòøÊãâ„Äå‰∏ô„ÄçÔºâ' },
      { q: '‰ªÄÈ∫ºÊù±Ë•øÊòéÊòéÊòØÂúìÁöÑÔºåÂ•ΩÂ§ö‰∫∫ÈÉΩË™™ÂÆÉÊòØÊñπÁöÑÔºü', a: 'ÊñπÂêëÁõ§' },
      { q: '‰ªÄÈ∫ºÈ¥®Â≠êÁî®ÂÖ©ÈöªËÖ≥Ëµ∞Ë∑ØÔºü', a: 'ÊâÄÊúâÁöÑÈ¥®Â≠êÔºàÊòØ‰∏çÊòØÊÉ≥Ë™™ÂîêËÄÅÈ¥®ÔºüÔºâ' },
      { q: '‰∏ÄËºõÂÆ¢ËªäÁôºÁîü‰∫Ü‰∫ãÊïÖÔºåÊâÄÊúâÁöÑ‰∫∫ÈÉΩÂèóÂÇ∑‰∫ÜÔºåÁÇ∫‰ªÄÈ∫ºÂ∞èÊòéÂçªÊ≤í‰∫ãÔºü', a: 'Âõ†ÁÇ∫‰ªñ‰∏çÂú®Ëªä‰∏ä' },
      { q: 'Âï¶Âï¶Èöä‰∏çÂáÜÂùê‰∏ãÔºàÁåúÂú∞ÈªûÔºâ', a: 'Âä†Ê≤πÁ´ô' },
      { q: 'ËºïËÅ≤Á¥∞Ë™ûÁöÑË™™ÔºàÁåúÈÅãÂãïÈ†ÖÁõÆÔºâ', a: 'ÊüîÈÅì' },
      { q: 'ÊòüÊòüÁöÑÈáçÈáèÊòØ 8 ÂÖ¨ÂÖãÔºàÁåú‰∏ÄÂìÅÁâåÔºâ', a: 'StarbucksÔºàÊòü"ÂÖ´ÂÖã"Ôºâ' },
      { q: 'ÂÅ∑‰ªÄÈ∫ºÊù±Ë•ø‰∏çÁäØÊ≥ïÔºü', a: 'ÂÅ∑Á¨ë' },
      { q: '‰ªÄÈ∫ºÂú∞ÊñπÂæàËºïÈ¨ÜÂ∞±ÂèØ‰ª•Áà¨‰∏äÂéªÔºåÂçªÂæàÈõ£‰∏ãÂæó‰æÜÔºü', a: 'Â∫ä‰∏ä' },
      { q: 'Áî®ÂçóÁìúÊâìÈ†≠ÂíåÁî®Ë•øÁìúÊâìÈ†≠ÔºåÂì™ÂÄãÊØîËºÉÁóõÔºü', a: 'È†≠ÊØîËºÉÁóõ' },
      { q: 'Â§ßÊúàÊúâ 31 Â§©ÔºåÂ∞èÊúàÊúâ 30 Â§©ÔºåÂì™ÂÄãÊúàÊúâ 28 Â§©Ôºü', a: 'ÊØèÂÄãÊúàÈÉΩÊúâ 28 Â§©' },
      { q: 'ÂÖ´ÂçÅÊ≠≤ÁÖßÈè°Â≠êÊúÉÊòØ‰ªÄÈ∫ºÊ®£Â≠êÔºü', a: 'ËÄÅÊ®£Â≠ê' },
      { q: 'Âì™ÂÄãÊï∏Â≠óÊúÄÊá∂ÔºüÂì™ÂÄãÊï∏Â≠óÊúÄÂã§Âø´Ôºü', a: '1 ÊúÄÊá∂Ôºå2 ÊúÄÂã§Âø´Ôºà‰∏Ä‰∏ç‰ΩúÔºå‰∫å‰∏ç‰ºëÔºâ' },
    ]
  }
];

// ================================================================
// STATE
// ================================================================
let state = {
  catIndex: 0,
  order: [],       // shuffled indices into riddles array
  pos: 0,          // position in order
  revealed: false,
  isRandom: false,
  randomPool: [],  // [{catIndex, riddleIndex}]
  randomPos: 0,
};

// ================================================================
// AUDIO (Web Audio API ‚Äì no external files)
// ================================================================
const AudioCtx = window.AudioContext || window.webkitAudioContext;
let audioCtx = null;

function getAudioCtx() {
  if (!audioCtx) audioCtx = new AudioCtx();
  return audioCtx;
}

function playChime() {
  try {
    const ctx = getAudioCtx();
    const notes = [523.25, 659.25, 783.99, 1046.5]; // C5 E5 G5 C6
    notes.forEach((freq, i) => {
      const osc = ctx.createOscillator();
      const gain = ctx.createGain();
      osc.connect(gain); gain.connect(ctx.destination);
      osc.type = 'sine';
      osc.frequency.value = freq;
      const t = ctx.currentTime + i * 0.12;
      gain.gain.setValueAtTime(0, t);
      gain.gain.linearRampToValueAtTime(0.25, t + 0.04);
      gain.gain.exponentialRampToValueAtTime(0.001, t + 0.5);
      osc.start(t);
      osc.stop(t + 0.5);
    });
  } catch(e) {}
}

function playBoing() {
  try {
    const ctx = getAudioCtx();
    const osc = ctx.createOscillator();
    const gain = ctx.createGain();
    osc.connect(gain); gain.connect(ctx.destination);
    osc.type = 'sine';
    osc.frequency.setValueAtTime(150, ctx.currentTime);
    osc.frequency.exponentialRampToValueAtTime(600, ctx.currentTime + 0.15);
    osc.frequency.exponentialRampToValueAtTime(300, ctx.currentTime + 0.4);
    gain.gain.setValueAtTime(0.3, ctx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + 0.5);
    osc.start(ctx.currentTime);
    osc.stop(ctx.currentTime + 0.5);
  } catch(e) {}
}

function playSound(catId) {
  if (catId === 'fun') playBoing();
  else playChime();
}

// ================================================================
// CONFETTI
// ================================================================
const confettiColors = ['#f39c12','#e74c3c','#f7dc6f','#ff6b6b','#fff','#ffd700','#ff9ff3'];

function launchConfetti() {
  const container = document.getElementById('confetti-container');
  container.innerHTML = '';
  const count = 40;
  for (let i = 0; i < count; i++) {
    const el = document.createElement('div');
    el.className = 'confetti-piece';
    el.style.setProperty('--delay', (Math.random() * 0.4) + 's');
    el.style.setProperty('--dur', (0.9 + Math.random() * 0.6) + 's');
    el.style.setProperty('--fall', (300 + Math.random() * 400) + 'px');
    el.style.setProperty('--rot', (Math.random() > 0.5 ? '' : '-') + (360 + Math.random()*360) + 'deg');
    el.style.left = (Math.random() * 100) + '%';
    el.style.top = (10 + Math.random() * 30) + '%';
    el.style.background = confettiColors[Math.floor(Math.random() * confettiColors.length)];
    el.style.transform = `rotate(${Math.random()*360}deg)`;
    container.appendChild(el);
  }
  setTimeout(() => { container.innerHTML = ''; }, 2000);
}

// ================================================================
// UTILITIES
// ================================================================
function shuffleArray(arr) {
  const a = [...arr];
  for (let i = a.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [a[i], a[j]] = [a[j], a[i]];
  }
  return a;
}

function makeOrder(len) {
  return Array.from({length: len}, (_, i) => i);
}

// ================================================================
// RENDER
// ================================================================
function renderHome() {
  document.getElementById('screen-home').classList.add('active');
  document.getElementById('screen-game').classList.remove('active');
}

function renderGame() {
  document.getElementById('screen-home').classList.remove('active');
  document.getElementById('screen-game').classList.add('active');
  updateGameUI();
}

function currentRiddle() {
  if (state.isRandom) {
    const ref = state.randomPool[state.randomPos];
    return {
      riddle: CATEGORIES[ref.catIndex].riddles[ref.riddleIndex],
      catId: CATEGORIES[ref.catIndex].id,
      catName: CATEGORIES[ref.catIndex].name,
    };
  }
  const cat = CATEGORIES[state.catIndex];
  const idx = state.order[state.pos];
  return { riddle: cat.riddles[idx], catId: cat.id, catName: cat.name };
}

function totalCount() {
  if (state.isRandom) return state.randomPool.length;
  return state.order.length;
}

function currentPos() {
  if (state.isRandom) return state.randomPos;
  return state.pos;
}

function updateGameUI() {
  const { riddle, catId, catName } = currentRiddle();
  const pos = currentPos();
  const total = totalCount();

  // Category label
  document.getElementById('game-cat-label').textContent =
    state.isRandom ? 'üé≤ Èö®Ê©üÊ®°Âºè' : CATEGORIES[state.catIndex].icon + ' ' + catName;

  // Category tag on card
  document.getElementById('riddle-category-tag').textContent = catName;

  // Riddle text
  document.getElementById('riddle-text').textContent = riddle.q;

  // Answer
  document.getElementById('answer-text').textContent = riddle.a;
  document.getElementById('answer-box').classList.remove('visible');
  document.getElementById('reveal-btn').style.display = '';

  state.revealed = false;

  // Progress
  const pct = total > 1 ? ((pos) / (total - 1)) * 100 : 100;
  document.getElementById('progress-fill').style.width = pct + '%';
  document.getElementById('progress-label').textContent = `${pos + 1} / ${total}`;

  // Nav buttons
  document.getElementById('prev-btn').disabled = pos === 0;
  document.getElementById('next-btn').disabled = pos === total - 1;

  // Shuffle btn visibility
  document.getElementById('shuffle-btn').style.display = state.isRandom ? 'none' : '';
}

// ================================================================
// ACTIONS
// ================================================================
function startCategory(catIndex) {
  state.isRandom = false;
  state.catIndex = catIndex;
  state.order = makeOrder(CATEGORIES[catIndex].riddles.length);
  state.pos = 0;
  renderGame();
}

function startRandom() {
  state.isRandom = true;
  const pool = [];
  CATEGORIES.forEach((cat, ci) => {
    cat.riddles.forEach((_, ri) => pool.push({ catIndex: ci, riddleIndex: ri }));
  });
  state.randomPool = shuffleArray(pool);
  state.randomPos = 0;
  renderGame();
}

function revealAnswer() {
  if (state.revealed) return;
  state.revealed = true;
  const { catId } = currentRiddle();
  document.getElementById('answer-box').classList.add('visible');
  document.getElementById('reveal-btn').style.display = 'none';
  playSound(catId);
  launchConfetti();
}

function goNext() {
  if (state.isRandom) {
    if (state.randomPos < state.randomPool.length - 1) {
      state.randomPos++;
      updateGameUI();
    }
  } else {
    if (state.pos < state.order.length - 1) {
      state.pos++;
      updateGameUI();
    }
  }
}

function goPrev() {
  if (state.isRandom) {
    if (state.randomPos > 0) {
      state.randomPos--;
      updateGameUI();
    }
  } else {
    if (state.pos > 0) {
      state.pos--;
      updateGameUI();
    }
  }
}

function shuffleCurrent() {
  if (state.isRandom) return;
  const cat = CATEGORIES[state.catIndex];
  state.order = shuffleArray(makeOrder(cat.riddles.length));
  state.pos = 0;
  updateGameUI();
  // Quick visual feedback ‚Äì rotate icon
  const btn = document.getElementById('shuffle-btn');
  btn.style.transform = 'rotate(360deg)';
  setTimeout(() => { btn.style.transform = ''; }, 300);
}

// ================================================================
// SWIPE SUPPORT
// ================================================================
let touchStartX = 0;
let touchStartY = 0;

function setupSwipe(el) {
  el.addEventListener('touchstart', e => {
    touchStartX = e.touches[0].clientX;
    touchStartY = e.touches[0].clientY;
  }, { passive: true });

  el.addEventListener('touchend', e => {
    const dx = e.changedTouches[0].clientX - touchStartX;
    const dy = e.changedTouches[0].clientY - touchStartY;
    if (Math.abs(dx) > Math.abs(dy) && Math.abs(dx) > 50) {
      if (dx < 0) goNext();
      else goPrev();
    }
  }, { passive: true });
}

// ================================================================
// INIT
// ================================================================
function buildHomeScreen() {
  const grid = document.getElementById('categories-grid');
  grid.innerHTML = '';
  CATEGORIES.forEach((cat, i) => {
    const card = document.createElement('div');
    card.className = 'cat-card';
    card.innerHTML = `
      <span class="cat-icon">${cat.icon}</span>
      <div class="cat-info">
        <div class="cat-name">${cat.name}</div>
        <div class="cat-hint">${cat.hint}</div>
      </div>
      <span class="cat-badge">${cat.riddles.length} È°å</span>
    `;
    card.addEventListener('click', () => startCategory(i));
    grid.appendChild(card);
  });
}

function init() {
  buildHomeScreen();

  document.getElementById('random-btn').addEventListener('click', startRandom);
  document.getElementById('back-btn').addEventListener('click', renderHome);
  document.getElementById('reveal-btn').addEventListener('click', revealAnswer);
  document.getElementById('prev-btn').addEventListener('click', goPrev);
  document.getElementById('next-btn').addEventListener('click', goNext);
  document.getElementById('shuffle-btn').addEventListener('click', shuffleCurrent);

  // Swipe on game card
  setupSwipe(document.getElementById('riddle-card'));
  setupSwipe(document.getElementById('screen-game'));

  // Keyboard support
  document.addEventListener('keydown', e => {
    const gameActive = document.getElementById('screen-game').classList.contains('active');
    if (!gameActive) return;
    if (e.key === 'ArrowRight' || e.key === 'ArrowDown') goNext();
    if (e.key === 'ArrowLeft'  || e.key === 'ArrowUp')   goPrev();
    if (e.key === ' ' || e.key === 'Enter') revealAnswer();
    if (e.key === 'Escape') renderHome();
  });
}

init();
</script>
</body>
</html>
